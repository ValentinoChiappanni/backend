{"version":3,"sources":["../../../lib/models/usuario.test.js"],"names":["describe","fede","beforeAll","Usuario","create","fechaNacimiento","nombre","apellido","jest","useFakeTimers","setSystemTime","Date","getTime","afterAll","useRealTimers","test","expect","toMatchObject","edad","toEqual","otroFede","build","daiana","esTocayoDe","toBeTruthy","toBeFalsy"],"mappings":";;AAAA;;AACA;;;;AAEAA,QAAQ,CAAC,SAAD,EAAY,MAAM;AACxB,MAAIC,IAAJ;AAEAC,EAAAA,SAAS,CAAC,YAAY;AACpB;AACA,UAAM,wBAAN;AAEAD,IAAAA,IAAI,GAAG,MAAME,iBAAQC,MAAR,CAAe;AAC1BC,MAAAA,eAAe,EAAE,YADS;AAE1BC,MAAAA,MAAM,EAAE,MAFkB;AAG1BC,MAAAA,QAAQ,EAAE;AAHgB,KAAf,CAAb,CAJoB,CAUpB;;AACAC,IAAAA,IAAI,CAACC,aAAL,CAAmB,QAAnB;AACAD,IAAAA,IAAI,CAACE,aAAL,CAAmB,IAAIC,IAAJ,CAAS,YAAT,EAAuBC,OAAvB,EAAnB;AACD,GAbQ,CAAT;AAeAC,EAAAA,QAAQ,CAAC,MAAM;AACb;AACAL,IAAAA,IAAI,CAACM,aAAL;AACD,GAHO,CAAR;AAKAC,EAAAA,IAAI,CAAC,gBAAD,EAAmB,MAAM;AAC3B;AACAC,IAAAA,MAAM,CAACf,IAAD,CAAN,CAAagB,aAAb,CAA2B;AACzBX,MAAAA,MAAM,EAAE,MADiB;AAEzBD,MAAAA,eAAe,EAAE;AAFQ,KAA3B;AAID,GANG,CAAJ;AAQAU,EAAAA,IAAI,CAAC,sDAAD,EAAyD,MAAM;AACjEC,IAAAA,MAAM,CAACf,IAAI,CAACiB,IAAN,CAAN,CAAkBC,OAAlB,CAA0B,EAA1B;AACD,GAFG,CAAJ;AAIAnB,EAAAA,QAAQ,CAAC,cAAD,EAAiB,MAAM;AAC7B;AACA,UAAMoB,QAAQ,GAAGjB,iBAAQkB,KAAR,CAAc;AAAEf,MAAAA,MAAM,EAAE,MAAV;AAAkBC,MAAAA,QAAQ,EAAE;AAA5B,KAAd,CAAjB;;AACA,UAAMe,MAAM,GAAGnB,iBAAQkB,KAAR,CAAc;AAAEf,MAAAA,MAAM,EAAE,QAAV;AAAoBC,MAAAA,QAAQ,EAAE;AAA9B,KAAd,CAAf;;AAEAQ,IAAAA,IAAI,CAAC,6BAAD,EAAgC,MAAM;AACxCC,MAAAA,MAAM,CAACf,IAAI,CAACsB,UAAL,CAAgBH,QAAhB,CAAD,CAAN,CAAkCI,UAAlC;AACD,KAFG,CAAJ;AAIAT,IAAAA,IAAI,CAAC,yBAAD,EAA4B,MAAM;AACpCC,MAAAA,MAAM,CAACf,IAAI,CAACsB,UAAL,CAAgBD,MAAhB,CAAD,CAAN,CAAgCG,SAAhC;AACD,KAFG,CAAJ;AAGD,GAZO,CAAR;AAaD,CAhDO,CAAR","sourcesContent":["import { cleanDb } from '../../test/db_utils';\nimport Usuario from './usuario';\n\ndescribe('Usuario', () => {\n  let fede;\n\n  beforeAll(async () => {\n    // Borramos todos los datos preexistentes en la base.\n    await cleanDb();\n\n    fede = await Usuario.create({\n      fechaNacimiento: '1991-10-30',\n      nombre: 'Fede',\n      apellido: 'Aloi',\n    });\n\n    // Fijamos la fecha actual con un fake para que el test no dependa del día en que se ejecuta.\n    jest.useFakeTimers('modern');\n    jest.setSystemTime(new Date('2020-12-16').getTime());\n  });\n\n  afterAll(() => {\n    // Volvemos a la fecha real.\n    jest.useRealTimers();\n  });\n\n  test('campos básicos', () => {\n    // Usamos toMatchObject y no toEquals para que solo mire los atributos que especificamos.\n    expect(fede).toMatchObject({\n      nombre: 'Fede',\n      fechaNacimiento: '1991-10-30',\n    });\n  });\n\n  test('edad - se calcula a partir de la fecha de nacimiento', () => {\n    expect(fede.edad).toEqual(29);\n  });\n\n  describe('es tocayo de', () => {\n    // El método build crea un objeto pero no lo persiste, por eso no hace falta el await.\n    const otroFede = Usuario.build({ nombre: 'Fede', apellido: 'Sierra' });\n    const daiana = Usuario.build({ nombre: 'Daiana', apellido: 'Sierra' });\n\n    test('alguien con el mismo nombre', () => {\n      expect(fede.esTocayoDe(otroFede)).toBeTruthy();\n    });\n\n    test('alguien con otro nombre', () => {\n      expect(fede.esTocayoDe(daiana)).toBeFalsy();\n    });\n  });\n});\n"],"file":"usuario.test.js"}